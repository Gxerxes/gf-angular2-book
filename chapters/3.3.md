备注：把组件分解和数据建模从项目实施章节提取到本节，简要说明各组件的开发步骤，从之前的组件开发部分抽离出来；（闫学凯 + 王扬）

### 3.2 项目实施

在上一个小节中，我们对项目进行了细致的需求分析。相信读者对该问卷系统要实现的功能有了比较清晰的认识。接下来，我们要开始正式的编码工作，使用Angular实现整个问卷系统。本小节将会讲述如何从零开始一步步的搭建整个项目的开发环境，以及项目的配置和启动方式，为后面真正的业务开发打好基础。 在正式开始搭建开发环境之前，首先来看下项目中使用到的技术。

#### 3.2.1 使用的技术

##### Angular2-seed

和从零开始搭建开发环境不同，现在开发者一般会选择一个合适的脚骨架，作为一个大型项目的基础开发环境。Angular2-seed作为一个功能完善的前端脚骨架，包含了应用中需要使用到的核心库和依赖.同时它还结合类似gulp这样的自动化构建工具，提供了开发模式下的自动编译、热加载以及自动化测试等实用功能。以下是Angular2-seed官方文档中提及的它的特性和功能点：

* 对已经存在的项目，做到了种子功能的无痛升级
* 通过和angular/mobile-toolkit的集成，实现了对ServiceWorkers和AppCache的直接支持
* 通过gulp实现TypeScript语言的编译，得以使用静态类型构建系统
* 支持开发和生产两种环境下的构建
* 使用Jasimine和Karma进行单元测试，使用istanbul统计代码覆盖率
* 使用Protractor进行端对端测试
* 开发模式下的热加载（Livereload）
* 遵循最佳实践
* 使用typings管理类型定义
* 自动前缀（autoprefixer）和css-lint支持

除了基本的核心库和依赖之外，Angular2-seed还提供了诸如ng2-translate, lodash等高级的依赖包和工具，感兴趣的读者可以查阅官方使用文档。总之，使用Angular2-seed可以帮助我们快速的搭建起问卷调查系统，省去了很多繁杂的配置工作。

> 备注：Angular2-seed需要node v4.x.x或以上版本，同时需要的npm版本为2.14.7。

##### angular2-bootstrap

可能大部分前端开发工程师都使用或者了解过bootstrap，它是Twitter推出的一款前端UI框架，使用bootstrap可以快速的开发漂亮的网页。angular2-bootstrap是一些angular2的指令集合，提供了类似bootstrap的漂亮的UI， 例如本例中会使用到的轮播图、警告框等。

##### json-server

json-server是一个简易的node server，用来模拟后端服务器。在真实的应用场景中，我们通常会使用express+mongodb或者php+mysql等来作为后端http服务，提供API与前端进行通信和数据持久化。但在本项目中，我们的重点是通过项目实例的方式介绍Angular2的应用，因此后端的开发我们尽量使用最简化的方式。json-server就是用来模拟server提供api服务的。它没有实际的数据库，采用纯json文本的方式存储数据，通过很少的代码就能搭建一个REST API server。关于json-server的具体用法，读者可以参考官方github上的文档，后面也会详细介绍在本项目中如何使用，这里就不做展开介绍了。

#### 3.2.2 环境搭建

了解了本例中将要使用到的技术后，接下来看下如何结合这些技术快速搭建起我们开发环境。

##### 搭建前端开发环境

首先创建根目录angular2-demo， 接着克隆Angular2-seed的源代码到本地目录下。

```bash
$ mkdir angular2-demo & cd angular2-demo
$ git clone --depth 1 https://github.com/mgechev/angular2-seed.git

```

> 备注：如果读者没有安装git，也可以直接从Angular2-seed的github主页上下载zip包并解压到根目录。

下载完成后，在根目录下会出现名称为angular2-seed的文件夹，修改文件夹名为frontend，用来标识它为前端文件目录。文件夹的目录结构如下：

```bash
|-- angular2-demo
        |-- frontend
                |-- src
                |-- gulpfile.ts			<- gulp任务的配置文件
                |-- karma.conf.js			<- 测试启动的配置文件
                |-- protractor.conf.js  <- 端对端测试的配置文件
                |-- package.json			<- 项目的依赖配置
                |-- tsconfig.json			<- typescript相关的配置
                ... ...
```

src是程序的主目录，同时我们还列举了几个比较重要的配置文件项。除此之外，还有诸如tslint.json、typings.json等配置文件，以及存放构建任务、种子相关配和环境变量配置等的tools文件夹，感兴趣的读者可以参阅官方git文档了解更多详细信息。

接下来，更改命令行当前目录为frontend，并开始安装依赖包，命令如下：

```bash
$ cd frontend & npm install
```

如果安装过程中，没有`npm Err!`产生，表明依赖包全部安装成功。安装完依赖包后，就可以使用如下命令启动项目了：

```bash
$ npm start
```

在package.json中配置了很多可以运行的命令参数，其中包括start：

```json
"scripts": {
    "build.dev": "gulp build.dev --color",
    "build.dev.watch": "gulp build.dev.watch --color",
    "build.e2e": "gulp build.e2e --color",
    "build.prod": "gulp build.prod --color",
    "build.test": "gulp build.test --color",
    ......
    "serve.dev": "gulp serve.dev --color",
    "serve.e2e": "gulp serve.e2e --color",
    "serve.prod": "gulp serve.prod --color",
    "start": "gulp serve.dev --color",
    ......
  },
```

start运行参数的值是`gulp serve.dev --color`，因此，执行`npm start`等同于执行`gulp serve.dev --color`。从gulp的参数上不难看出，这是以开发模式来启动项目的。执行后，命令行窗口中会出现如下信息：

```bash
[BS] Access URLs:
 --------------------------------------
       Local: http://localhost:5555/
    External: http://192.168.56.1:5555/
 --------------------------------------
          UI: http://localhost:3001
 UI External: http://192.168.56.1:3001
 --------------------------------------
[BS] Serving files from: dist/empty/

```

同时，浏览器会自动打开http://localhost:5555/，并显示Angular 2 Seed的demo页面，这表明项目启动成功了！

> 如果你是在window系统上开发，那么还需要先将TypeScript文件编译成JavaScript文件，因为项目的构建工具也是使用TypeScript编写的。命令如下：

> ```bash
$ tsc --project tsconfig.json
$ npm start
```

> 如果出现`tsc 命令找不到`类似的错误信息，则需要先全局安装TypeScript:

> ```bash
$ npm install -g typescript
```